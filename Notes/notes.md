# 技术笔记汇总

## 1. Linux 文件系统

### 1.1 标准 Linux 系统目录
| 目录名   | 作用说明 |
|----------|----------|
| `/bin`   | 基本系统命令，如 `ls`、`cp` 等，所有用户可用，系统启动就需要。 |
| `/sbin`  | 系统管理命令，如 `ifconfig`、`reboot`，通常 root 用户使用。 |
| `/etc`   | 系统配置文件目录，如网络配置、init 脚本等。 |
| `/lib`   | 程序运行所需的共享库（`.so` 文件）。 |
| `/dev`   | 设备文件目录，表示硬件接口，如串口、存储设备等。 |
| `/proc`  | 虚拟文件系统，提供内核和进程的运行时信息。 |
| `/sys`   | 提供内核与硬件设备的接口配置，通常用于设备驱动控制。 |
| `/tmp`   | 临时文件存放目录，位于内存中，重启后清空。 |
| `/usr`   | 用户工具和库目录，如 `/usr/bin`、`/usr/lib` 等。 |
| `/var`   | 存放可变数据，如日志文件、缓存、PID 文件等。 |
| `/root`  | root（超级用户）的主目录。 |
| `/home`  | 普通用户的主目录（OpenWrt 通常不使用）。 |
| `/mnt`   | 外部存储挂载点，如 U 盘、SD 卡。 |

### 1.2 嵌入式 / OpenWrt 常见目录
| 目录名     | 作用说明 |
|------------|----------|
| `/overlay` | Overlay 文件系统挂载点，系统变更（如配置）会写入这里。 |
| `/rom`     | 固件的只读根文件系统部分，可用于恢复出厂设置。 |
| `/www`     | Web 页面和资源文件目录，通常是 LuCI 界面所在路径。 |
| `/data`    | 用于存储用户或系统运行数据（厂商自定义）。 |
| `/cfg`     | 存储系统配置或备份信息（厂商自定义）。 |
| `/ini`     | 初始化参数目录，可能存储模块启动配置（厂商自定义）。 |
| `/bus`     | 总线通信或模块交互的目录（厂商自定义）。 |

## 2. 网络技术

### 2.1 网络隔离与虚拟化

#### 2.1.1 VLAN（虚拟局域网）
- 虚拟局域网，用于逻辑隔离网络的技术

##### 2.1.1.1 ACCESS 端口（接入端口）
1. 一个ACCESS端口通常只属于一个VLAN，例如：VLAN 10
2. 不打标签（untagged）：从设备发来的帧是普通的以太网帧，交换机在发送这个端口时也不会打VLAN标签
3. 连接终端设备(PC、服务器等)

帧结构 [Ethernet Header][Payload][FCS]

##### 2.1.1.2 TRUNK（干道端口）
1. 承载多个VLAN（可以同时传输VLAN 10、VLAN20 的流量）
2. 打标签（tagged）：发送到另一台路由器或交换机的帧，会附加802.1Q标签表示VLAN ID
3. 连接交换机或路由器，用于交换机间互联或者连接支持VLAN的服务器

帧结构 [Ethernet Header][VLAN Tag][Payload][FCS]

#### 2.1.2 VXLAN
- 将L2的以太帧封装到UDP报文，并在L3网络中传输
- 把原本只能在一个大楼（VLAN）里传的二层网络，装进快递盒子（UDP/IP 封装），送到任意大楼（跨三层网络），让大家依旧像在同一个部门（VNI）里一样互通。

#### 2.1.3 EVPN
- 将EVPN作为VXLAN的控制平面
- 可实现VTEP自动发现，VXLAN隧道自动建立
- EVPN可以同时发布二层MAC信息和三层路由信息
- 减少网络中的泛洪流量

### 2.2 网络地址与路由

#### 2.2.1 IP地址与子网掩码
- `/24` = 子网掩码 255.255.255.0，定义了网段大小
- 加上 `/24` → 明确告诉系统"这是一个网段里的地址"
- 不加 `/24` → 只是单个IP地址

#### 2.2.2 DNAT 配置
- DNAT（目标网络地址转换）：把到达某个IP的数据包，改写目标地址后转发到内部网络的另一台主机，实现公网访问内网
- 配合SNAT或MASQUERADE使用，保证回包能回到公网

#### 2.2.3 MASQ配置
- 把内网设备访问公网的数据包的源IP改成路由器的公网IP

#### 2.2.4 ICMP检测
- ICMP（Internet Control Message Protocol，互联网控制报文协议）
- 用ping的方式判断目标是否可达

#### 2.2.5 DDNS
- Dynamic DNS（动态域名系统）
- 当设备的公网IP地址发生变化时，自动将新的IP更新到域名解析服务上
- 用户可以用固定的域名访问设备，而不需要关心IP会变

### 2.3 移动网络技术

#### 2.3.1 SA/NSA 组网模式
- NSA (非独立组网)：5G基站依赖4G基站作为锚点（主控），数据和信令部分走4G，只有部分数据走5G NR。模块需要同时连接LTE（4G）和NR（5G）信号
- SA (独立组网)：5G基站和核心网都是5G（NR + 5GC），不依赖4G。模块直接在5G网络上进行信令和数据交互

#### 2.3.2 移动网络关键参数
- 网络频段：决定了连接的"大道"还是"小路"
- PCI：GPS正在跟踪的"车牌号"
- 频点：车牌号所行驶道路的"精确坐标"
- SCS：道路的车型（小SCS 15/30kHz 类似于大型货轮，大SCS 60/120kHz 类似于F1赛车），决定了能跑多快多稳

## 3. 编程语言与开发

### 3.1 C语言基础

#### 3.1.1 字符与字符串
| 形式    | 含义   | 类型                 | 示例                           |
| ----- | ---- | ------------------ | ---------------------------- |
| `'a'` | 单个字符 | `int`              | `char c = 'a';`              |
| `"a"` | 字符串  | `char[]` → `char*` | `char s[2]; strcpy(s, "a");` |

#### 3.1.2 结构体访问运算符
| 运算符  | 用法                   | 示例                        |
| ---- | -------------------- | ------------------------- |
| `.`  | 访问 **结构体变量** 成员      | `s.field`                 |
| `->` | 访问 **结构体指针** 指向对象的成员 | `p->field` ≈ `(*p).field` |

#### 3.1.3 C语言常用函数
```c
char *strdup(const char *s);  //复制字符串到新内存  
size_t strcspn(const char *s, const char *reject); //查找某字符集在字符串中首次出现的位置
char *strcat(char *dest, const char *src); //将一个字符串追加到另一个字符串的末尾
char *strtok(char *str, const char *delim); //分隔符切分字符串的函数（原地修改字符串 + 静态指针记住位置） 字符串必须是可修改的，常量存储区会崩溃
char *strrchr(const char *s, int c); //找最后一次出现某字符的位置
char *strchr(const char *s, int c); //找第一次出现该字符的位置的指针
pthread_join(thread, &retval);  //阻塞等待线程结束，并回收线程资源，可获取返回值 (线程必须未 detach，否则报错)
pthread_detach(thread)          //线程结束后自动释放资源，不需 join 
```

### 3.2 安全与加密

#### 3.2.1 哈希算法
- MD5、SHA256、SM3 都是哈希算法，用于生成数据的唯一指纹
- MD5：128位哈希值，速度快但安全性较低
- SHA256：256位哈希值，安全性较高
- SM3：中国国家密码局发布的哈希算法标准

## 4. 系统命令与工具

### 4.1 Linux 基本命令
- `ls -l xxx`：查询快捷方式的原始地址
- `df`：查看磁盘空间使用情况
- `disable/enable`：停止/使能进程
- `-f` 和 `-F` 的区别：
  - `-f` 只是跟踪当前打开的文件描述符
  - `-F` 不仅跟踪，还会在文件被替换（inode变化）时自动重新打开文件
- `kill -9 PID`：强制杀死进程

### 4.2 网络诊断工具
- `tcpdump -i eth0 port 1883 -s0 -x`：
  - tcpdump是Linux下的抓包工具
  - `-i eth0`：在eth0网口上进行抓包
  - `port 1883`：只抓取源端口或目标端口是1883的数据
  - `-s0`：不截断，抓取完整的数据包
  - `-x`：以16进制的形式打印，会将payload数据也打印出来

- `swconfig dev switch0 show | grep link`：查看交换机端口链路状态

### 4.3 CLI（命令行界面）
- 通过输入命令与程序或设备交互的方式
- 通常比图形界面更高效，适用于自动化脚本和远程管理

## 5. 常见问题解答

### 5.1 编译相关
**Q: 如何编译Z1**  
**A:** 在Release目录下执行`make all/hongdian`

### 5.2 网络连接问题
**Q: 为什么无法正常拨号**  
**A:** 要选择兼容Z1板的模块



